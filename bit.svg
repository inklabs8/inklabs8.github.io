<svg xmlns="http://www.w3.org/2000/svg" width="500" height="400" viewBox="0 0 500 400" version="2">


	<desc>Example script01 - invoke an ECMAScript function from an onclick event
	</desc>

	<!-- UI Definitions -->
	<defs>

	</defs>


  	<g id="console">
  	
	  	<g id="scene">
			<circle id="ship" cx="200" cy="200" r="10" fill="blue"/>
		</g>

		<g id="hud">
		</g>

		<rect id="inputCard" tabindex="0" x="0" y="0" width="100%" height="100%" fill="blue" opacity="0.1"/>

	</g>&gt;

	<!-- ECMAScript to change the radius with each click -->
	<script id="bit-console-xyz"> //<![CDATA[
		console.log("starting firmware");

		var bitConsole = {

			cartridge: null,

			screen: {
				width: 500,
				height: 400,
			},

			gamepad : {

			},

			loadGame: function(cartridge){
				if (!cartridge) 
					return;
				this.cartridge = cartridge;
				
				this.cartridge.initialize(this);
				return cartridge;
			},

			wrap: function(objId) {
				return document.getElementById(objId);
			}
		}


		var intervalID = setInterval(myCallback, 33, 'Parameter 1', 'Parameter 2');

		function myCallback(a, b)
		{
			if (!this.cartridge) 
				return;

			dx = 0; dy = 0;
			if (pressedKey[37] == 1) dx = -1;
			if (pressedKey[39] == 1) dx = 1;    	    	
			if (pressedKey[38] == 1) dy = -1;
			if (pressedKey[40] == 1) dy = 1;
			
			this.cartridge.move(dx, dy);
		}

		pressedKey = {}

		function screen_click(evt) {
			console.log("Engine reactive");
			var t = document.getElementById("ship");
		  	var currentRadius = t.getAttribute("r");
			if (currentRadius == 10)
				t.setAttribute("r", currentRadius*2);
			else
				t.setAttribute("r", currentRadius*0.5);
		}

		function input_keyup(e) {
			pressedKey[e.keyCode] = 0;
		}

		function input_keydown(e) {
			pressedKey[e.keyCode] = 1;
		}

		var inputCard = document.getElementById("inputCard");
		inputCard.addEventListener("keydown", input_keydown)
		inputCard.addEventListener("keyup", input_keyup)
		inputCard.addEventListener("click", screen_click)

		console.log("firmware online");
	//]]> </script>

	<script id="bit-game-xyz"> //<![CDATA[

		
		var cartridge = {
			
			btc: null,

			ship: null,

			initialize: function (bitConsole) {
				this.btc = bitConsole;
				this.ship = this.btc.wrap("ship");
			},

			move: function (dx, dy) {
				step = 5;

				s = this.ship;
				if (dx != 0) {
			    	var x = parseInt(s.getAttribute("cx"));
				    s.setAttribute("cx", (x + dx*step));
			    }
			    if (dy != 0) {
				    var y = parseInt(s.getAttribute("cy"));
				    s.setAttribute("cy", (y + dy*step));
			    }		
			},

			act: function(a, b) {

			},

			scene: function() {

			}
		}


		bitConsole.loadGame(cartridge);

	//]]> </script>

</svg>
